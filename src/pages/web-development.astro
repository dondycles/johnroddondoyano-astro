---
import RootLayout from '@/layouts/RootLayout.astro';
import { TbCode } from 'react-icons/tb';

import { EXPERIENCES } from '@/lib/experiences';
import { OWN_PROJECTS } from '@/lib/own-projects';
import { TECH_STACKS } from '@/lib/tech-stacks';

const profilePageSchema = {
  '@context': 'https://schema.org',
  '@type': 'ProfilePage',
  mainEntity: {
    '@type': 'Person',
    name: 'John Rod Dondoyano',
    url: 'https://johnroddondoyano.com',
    jobTitle: 'Musician & Web Developer',
    knowsAbout: TECH_STACKS.map((stack) => stack.name),
  },
};

const experienceListSchema = {
  '@context': 'https://schema.org',
  '@type': 'ItemList',
  name: 'Web Development Experiences by John Rod Dondoyano',
  itemListElement: EXPERIENCES.map((exp, i) => ({
    '@type': 'ListItem',
    position: i + 1,
    item: {
      '@type': 'CreativeWork',
      name: exp.name,
      description: exp.description,
      datePublished: exp.date,
      url: exp.links[0]?.link,
    },
  })),
};

const projectListSchema = {
  '@context': 'https://schema.org',
  '@type': 'ItemList',
  name: 'Personal Projects by John Rod Dondoyano',
  itemListElement: OWN_PROJECTS.map((project, i) => ({
    '@type': 'ListItem',
    position: i + 1,
    item: {
      '@type': 'WebApplication',
      name: project.name,
      description: project.description,
      url: project.links[0]?.link,
    },
  })),
};
---

<RootLayout
  seo={{
    title: 'Web Development | ',
    description:
      "Explore John Rod Dondoyano's web development portfolio — professional experiences, personal projects, and tech stacks including React, Next.js, TypeScript, Supabase, and more.",
  }}
>
  <script type="application/ld+json" set:html={JSON.stringify(profilePageSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(experienceListSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(projectListSchema)} />

  <header>
    <h1>
      <TbCode client:only className="inline" aria-hidden="true" />
      Web Development
    </h1>
    <p class="prose-a:underline">
      A hobby of creating sleek websites — built with modern frameworks and a passion for
      pixel-perfect, performant user experiences.
    </p>
  </header>

  <section class="rounded-3xl border px-4 pb-12 shadow-lg" aria-label="Technical skills and tools">
    <article>
      <h2>Tech Stacks</h2>
      <ul
        class="prose-li:mb-0 prose-li:mt-0 mb-0 flex list-none flex-wrap gap-4 p-0 text-2xl"
        role="list"
      >
        {
          TECH_STACKS.map((stack, i) => (
            <li class="dark:bg-input/30 flex items-center gap-1 rounded-2xl border p-4">
              <stack.icon aria-hidden="true" />
              <p class="mt-0 mb-0 text-base">
                <span>{stack.name}</span>
                <span hidden={TECH_STACKS.length === i + 1} class="-ml-2 text-base">
                  ,
                </span>
              </p>
            </li>
          ))
        }
      </ul>
    </article>
  </section>

  <section class="rounded-3xl border px-4 pb-12 shadow-lg" aria-label="Professional experiences">
    <article>
      <h2>Experiences</h2>
      <p>My experiences so far</p>
      <div class="flex flex-col divide-y rounded-2xl border">
        {
          EXPERIENCES.map((exp) => (
            <section class="px-4 py-12">
              <div class="inline-flex items-center gap-4">
                <img
                  src={exp.icon as string}
                  alt={`${exp.name} logo`}
                  class="mt-0 mb-auto h-10 w-fit"
                  width="40"
                  height="40"
                  loading="lazy"
                />
                <h3 class="mt-0 mb-0">{exp.name}</h3>
              </div>
              <p>{exp.description}</p>
              <p>
                <time>{exp.date}</time>
              </p>
              <div class="flex flex-wrap items-end gap-4 text-2xl">
                <p class="mt-0 mb-0 text-base">stacks: </p>
                {exp.tech_stacks.map((stack, i) => (
                  <div class="inline-flex items-center gap-1">
                    <stack.icon aria-hidden="true" />
                    <span class="mt-0 mb-0 text-base">
                      {stack.name}
                      {exp.tech_stacks.length === i + 1 ? null : ','}
                    </span>
                  </div>
                ))}
              </div>
              <div class="prose-a:underline flex flex-wrap items-end gap-2">
                <p class="mb-0">links: </p>
                {exp.links.map((link, i) => (
                  <a
                    href={link.link}
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label={`Visit ${link.name} for ${exp.name}`}
                    class="prose-p:mb-0 prose-p:mt-0 inline-flex"
                  >
                    <span>
                      {link.name}
                      {exp.links.length === i + 1 ? null : ','}
                    </span>
                  </a>
                ))}
              </div>
            </section>
          ))
        }
      </div>
    </article>
  </section>

  <section class="rounded-3xl border px-4 pb-12 shadow-lg" aria-label="Personal projects">
    <article>
      <h2>Other Projects</h2>
      <p>Just for fun</p>
      <div class="flex flex-col divide-y rounded-2xl border">
        {
          OWN_PROJECTS.map((project) => (
            <section class="px-4 py-12">
              <div class="inline-flex items-center gap-4">
                <img
                  src={project.icon as string}
                  alt={`${project.name} logo`}
                  class="mt-0 mb-auto h-10 w-fit"
                  width="40"
                  height="40"
                  loading="lazy"
                />
                <h3 class="mt-0 mb-0">{project.name}</h3>
              </div>
              <p>{project.description}</p>
              <div class="flex flex-wrap items-end gap-4 text-2xl">
                <p class="mt-0 mb-0 text-base">stacks: </p>
                {project.tech_stacks.map((stack, i) => (
                  <div class="inline-flex items-center gap-1">
                    <stack.icon aria-hidden="true" />
                    <span class="mt-0 mb-0 text-base">
                      {stack.name}
                      {project.tech_stacks.length === i + 1 ? null : ','}
                    </span>
                  </div>
                ))}
              </div>
              <div class="prose-a:underline flex flex-wrap items-end gap-2">
                <p class="mb-0">links: </p>
                {project.links.map((link, i) => (
                  <a
                    href={link.link}
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label={`Visit ${link.name} for ${project.name}`}
                    class="prose-p:mb-0 prose-p:mt-0 inline-flex"
                  >
                    <span>
                      {link.name}
                      {project.links.length === i + 1 ? null : ','}
                    </span>
                  </a>
                ))}
              </div>
            </section>
          ))
        }
      </div>
    </article>
  </section>
</RootLayout>

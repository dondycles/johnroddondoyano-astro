---
import RootLayout from '@/layouts/RootLayout.astro';
import { TbCode } from 'react-icons/tb';

import FormWithRecaptcha from '@/components/FormWithRecaptcha';
import { Button } from '@/components/ui/button';
import { EXPERIENCES } from '@/lib/experiences';
import { OWN_PROJECTS } from '@/lib/own-projects';
import { TECH_STACKS } from '@/lib/tech-stacks';
import { ChevronLeft } from 'lucide-react';

const profilePageSchema = {
  '@context': 'https://schema.org',
  '@type': 'ProfilePage',
  mainEntity: {
    '@type': 'Person',
    name: 'John Rod Dondoyano',
    url: 'https://johnroddondoyano.com',
    jobTitle: 'Musician & Web Developer',
    knowsAbout: TECH_STACKS.map((stack) => stack.name),
  },
};

const experienceListSchema = {
  '@context': 'https://schema.org',
  '@type': 'ItemList',
  name: 'Web Development Experiences by John Rod Dondoyano',
  itemListElement: EXPERIENCES.map((exp, i) => ({
    '@type': 'ListItem',
    position: i + 1,
    item: {
      '@type': 'CreativeWork',
      name: exp.name,
      description: exp.description,
      datePublished: exp.date,
      url: exp.links[0]?.link,
    },
  })),
};

const projectListSchema = {
  '@context': 'https://schema.org',
  '@type': 'ItemList',
  name: 'Personal Projects by John Rod Dondoyano',
  itemListElement: OWN_PROJECTS.map((project, i) => ({
    '@type': 'ListItem',
    position: i + 1,
    item: {
      '@type': 'WebApplication',
      name: project.name,
      description: project.description,
      url: project.links[0]?.link,
    },
  })),
};

const breadcrumbSchema = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    {
      '@type': 'ListItem',
      position: 1,
      name: 'Home',
      item: 'https://johnroddondoyano.com',
    },
    {
      '@type': 'ListItem',
      position: 2,
      name: 'Web Development',
      item: 'https://johnroddondoyano.com/web-development',
    },
  ],
};
---

<RootLayout
  seo={{
    title: 'Web Development | ',
    description:
      "Explore John Rod Dondoyano's web development portfolio — professional experiences, personal projects, and tech stacks including React, Next.js, TypeScript, Supabase, and more.",
  }}
>
  <script type="application/ld+json" set:html={JSON.stringify(profilePageSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(experienceListSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(projectListSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />

  <header class="bg-foreground dark:bg-foreground w-full shadow-[0px_12px_0px_#00000011]">
    <div class="mx-auto max-w-2xl px-4 py-16 sm:py-24">
      <a href="/" aria-label="Go back to home page">
        <Button variant={'inverted'}><ChevronLeft /> Back to Home </Button>
      </a>
      <h1 class="text-background mt-24 text-4xl font-bold">
        <TbCode client:only className="inline" aria-hidden="true" />
        Web Development
      </h1>
      <p class="text-muted-foreground mt-6">
        A hobby of creating sleek websites — built with modern frameworks and a passion for
        pixel-perfect, performant user experiences.
      </p>
    </div>
  </header>
  <section class="px-4 py-12" aria-label="Technical skills and tools">
    <article class="space-y-6">
      <h2 class="text-2xl font-bold">Tech Stacks</h2>
      <ul class="mb-0 flex list-none flex-wrap gap-4 p-0 text-2xl" role="list">
        {
          TECH_STACKS.map((stack, i) => (
            <li class="dark:bg-input/30 hover active flex items-center gap-1 border p-4 shadow">
              <stack.icon aria-hidden="true" />
              <p class="text-base">
                <span>{stack.name}</span>
                <span hidden={TECH_STACKS.length === i + 1} class="-ml-2 text-base">
                  ,
                </span>
              </p>
            </li>
          ))
        }
      </ul>
    </article>
  </section>
  <section class="border-t px-4 py-12" aria-label="Professional experiences">
    <article class="space-y-6">
      <h2 class="text-2xl font-bold">Experiences</h2>
      <p class="text-muted-foreground">My experiences so far</p>
      <div class="flex flex-col gap-4">
        {
          EXPERIENCES.map((exp) => (
            <section class="hover active space-y-6 border px-4 py-12 shadow">
              <div class="inline-flex items-center gap-4">
                <img
                  src={exp.icon as string}
                  alt={`${exp.name} logo`}
                  class="mt-0 mb-auto h-10 w-fit"
                  width="40"
                  height="40"
                  loading="lazy"
                />
                <h3 class="text-lg font-bold">{exp.name}</h3>
              </div>
              <p class="text-muted-foreground">{exp.description}</p>
              <p class="text-muted-foreground text-sm">
                <time datetime={exp.date}>{exp.date}</time>
              </p>
              <div class="flex flex-wrap items-end gap-4 text-sm">
                <span class="text-muted-foreground">stacks: </span>
                {exp.tech_stacks.map((stack, i) => (
                  <div class="inline-flex items-center gap-1">
                    <stack.icon aria-hidden="true" />
                    <span>
                      {stack.name}
                      {exp.tech_stacks.length === i + 1 ? null : ','}
                    </span>
                  </div>
                ))}
              </div>
              <div class="flex flex-wrap items-end gap-2 text-sm">
                <span class="text-muted-foreground">links: </span>
                {exp.links.map((link, i) => (
                  <a
                    href={link.link}
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label={`Visit ${link.name} for ${exp.name}`}
                    class="inline-flex"
                  >
                    <span>
                      {link.name}
                      {exp.links.length === i + 1 ? null : ','}
                    </span>
                  </a>
                ))}
              </div>
            </section>
          ))
        }
      </div>
    </article>
  </section>
  <section class="border-t px-4 py-12" aria-label="Personal projects">
    <article class="space-y-6">
      <h2 class="text-2xl font-bold">Other Projects</h2>
      <p class="text-muted-foreground">Just for fun</p>
      <div class="flex flex-col gap-4">
        {
          OWN_PROJECTS.map((project) => (
            <section class="hover active space-y-6 border px-4 py-12 shadow">
              <div class="inline-flex items-center gap-4">
                <img
                  src={project.icon as string}
                  alt={`${project.name} logo`}
                  class="mt-0 mb-auto h-10 w-fit"
                  width="40"
                  height="40"
                  loading="lazy"
                />
                <h3 class="text-xl font-bold">{project.name}</h3>
              </div>
              <p class="text-muted-foreground">{project.description}</p>
              <div class="flex flex-wrap items-end gap-4 text-sm">
                <span class="text-muted-foreground">stacks: </span>
                {project.tech_stacks.map((stack, i) => (
                  <div class="inline-flex items-center gap-1">
                    <stack.icon aria-hidden="true" />
                    <span>
                      {stack.name}
                      {project.tech_stacks.length === i + 1 ? null : ','}
                    </span>
                  </div>
                ))}
              </div>
              <div class="flex flex-wrap items-end gap-2 text-sm">
                <span class="text-muted-foreground">links: </span>
                {project.links.map((link, i) => (
                  <a
                    href={link.link}
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label={`Visit ${link.name} for ${project.name}`}
                    class="inline-flex"
                  >
                    <span>
                      {link.name}
                      {project.links.length === i + 1 ? null : ','}
                    </span>
                  </a>
                ))}
              </div>
            </section>
          ))
        }
      </div>
    </article>
  </section>
  <FormWithRecaptcha client:load />
</RootLayout>

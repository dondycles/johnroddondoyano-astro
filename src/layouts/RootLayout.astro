---
interface Props {
  seo?: {
    title?: string;
    description?: string;
  };
}
import FormWithRecaptcha from '@/components/FormWithRecaptcha';
import { Toaster } from '@/components/ui/sonner';
import { MUSIC_STORES } from '@/lib/music-stores';
import { SOCIALS } from '@/lib/socials';
import '@/styles/global.css';
import '@fontsource/google-sans-flex';
import { SEO } from 'astro-seo';

const { seo } = Astro.props;
const url = Astro.url;
const canonicalURL = new URL(url.pathname, url);
const siteURL = new URL('/', url);
const webSiteSchema = new URL('/#/schema/WebSite', Astro.url);

const DEFAULT_TITLE = 'John Rod Dondoyano';
const DEFAULT_DESCRIPTION =
  'Pianist with 316k+ YouTube subscribers and web developer. Explore 360+ piano sheets, MIDI files, and stream piano covers on Spotify, Apple Music, and more.';

const KEYWORDS = [
  'John Rod Dondoyano',
  'musician',
  'web developer',
  'pianist',
  'piano covers',
  'piano sheet music',
  'MIDI files',
  'MusicXML',
  'YouTube pianist',
  'music streaming',
  'Spotify artist',
  'piano tutorials',
  'piano sheet music',
  'MIDI files',
  'MusicXML',
  'YouTube pianist',
  'web developer',
  'music streaming',
  'Spotify artist',
  'piano tutorials',
];

const structuredData = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  '@id': webSiteSchema,
  name: DEFAULT_TITLE,
  url: siteURL,
  description: DEFAULT_DESCRIPTION,
  author: {
    '@type': 'Person',
    name: 'John Rod Dondoyano',
    url: 'https://johnroddondoyano.com',
    sameAs: [
      'https://youtube.com/johnroddondoyano',
      'https://tiktok.com/@dondycles',
      'https://open.spotify.com/artist/2opN2BRNgnBJIO932Kyr3U',
      'https://music.apple.com/us/artist/john-rod-dondoyano/1716913960',
      'https://github.com/dondycles',
      'https://instagram.com/dondycles',
      'https://x.com/dondycles',
      'https://facebook.com/dondycles',
    ],
  },
  publisher: {
    '@type': 'Person',
    name: 'John Rod Dondoyano',
  },
  inLanguage: 'en-US',
  potentialAction: {
    '@type': 'SearchAction',
    target: {
      '@type': 'EntryPoint',
      urlTemplate: 'https://johnroddondoyano.com/?s={search_term_string}',
    },
    'query-input': 'required name=search_term_string',
  },
};
---

<!-- <script is:inline>
  const getThemePreference = () => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme');
    }
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  };
  const isDark = getThemePreference() === 'dark';
  document.documentElement.classList[isDark ? 'add' : 'remove']('dark');

  if (typeof localStorage !== 'undefined') {
    const observer = new MutationObserver(() => {
      const isDark = document.documentElement.classList.contains('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });
    observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });
  }
</script> --><!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />

    <!-- SEO Meta Tags -->
    <meta name="author" content="John Rod Dondoyano" />
    <meta name="keywords" content={KEYWORDS.join(', ')} />
    <meta
      name="robots"
      content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"
    />
    <meta name="theme-color" content="#000000" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Canonical and Sitemap -->
    <link rel="canonical" href={canonicalURL} />
    <link rel="sitemap" href="/sitemap-index.xml" />

    <!-- Structured Data -->
    <script is:inline type="application/ld+json" set:html={JSON.stringify(structuredData)} />

    <!-- SEO Component -->
    <SEO
      title={seo?.title ? `${seo?.title}${DEFAULT_TITLE}` : DEFAULT_TITLE}
      titleDefault={DEFAULT_TITLE}
      description={seo?.description ?? DEFAULT_DESCRIPTION}
      openGraph={{
        basic: {
          title: seo?.title ?? DEFAULT_TITLE,
          type: 'website',
          image: `${url.origin}/summary-new.png`,
          url: `${url.origin}${url.pathname}`,
        },
        optional: {
          description: seo?.description ?? DEFAULT_DESCRIPTION,
          siteName: DEFAULT_TITLE,
          locale: 'en_US',
        },
        image: {
          alt: 'John Rod Dondoyano - Musician and Web Developer',
        },
      }}
      twitter={{
        title: seo?.title ?? DEFAULT_TITLE,
        description: seo?.description ?? DEFAULT_DESCRIPTION,
        card: 'summary_large_image',
        image: `${url.origin}/summary-new.png`,
        imageAlt: 'John Rod Dondoyano - Musician and Web Developer',
        creator: '@dondycles',
        site: '@dondycles',
      }}
      extend={{
        meta: [
          { name: 'twitter:label1', content: 'YouTube Subscribers' },
          { name: 'twitter:data1', content: '316k+' },
          { name: 'twitter:label2', content: 'Piano Sheets' },
          { name: 'twitter:data2', content: '360+' },
          { name: 'twitter:label3', content: 'MIDI/MusicXML Files' },
          { name: 'twitter:data3', content: '120+' },
          { name: 'twitter:label4', content: 'Listeners on Music Streaming Platforms' },
          { name: 'twitter:data4', content: '14k+' },
        ],
      }}
    />
  </head>
  <body class="font-google-sans-flex text-foreground bg-background antialiased [&_a]:underline">
    <main
      class="flex w-full flex-col shadow-[0px_12px_0px_#00000011] [&>*:not(header):not(footer)]:mx-auto [&>*:not(header):not(footer)]:max-w-2xl"
    >
      <slot />
      <FormWithRecaptcha client:load />
      <footer class="bg-primary text-background w-full" role="contentinfo">
        <div class="mx-auto w-full max-w-2xl space-y-12 px-4 py-24">
          <h2 class="text-2xl font-bold">Let's Connect!</h2>
          <div
            class="mx-auto flex flex-wrap justify-between gap-24 [&>nav>a]:no-underline [&>nav>a]:hover:underline"
          >
            <nav class="flex flex-col gap-1 text-left" aria-label="Social media links">
              <h3 class="text-muted-foreground mb-6 text-base font-normal">Socials</h3>
              {
                SOCIALS.map((social) => (
                  <a href={social.link} target="_blank" rel="noopener noreferrer me">
                    <span>{social.name}</span>
                  </a>
                ))
              }
            </nav>
            <nav class="flex flex-col gap-1 text-left" aria-label="Music streaming platforms">
              <h3 class="text-muted-foreground mb-6 text-base font-normal">Music Stores</h3>
              {
                MUSIC_STORES.map((musicStore) => (
                  <a href={musicStore.url} target="_blank" rel="noopener noreferrer">
                    <span>{musicStore.name}</span>
                  </a>
                ))
              }
            </nav>
            <nav
              class="flex flex-col gap-1 text-left"
              aria-label="Purchase sheet music and MIDI files"
            >
              <h3 class="text-muted-foreground mb-6 text-base font-normal">Purchase</h3>
              <a
                href="https://mymusicsheet.com/johnroddondoyano"
                target="_blank"
                rel="noopener noreferrer"
              >
                <span>Piano Sheets</span>
              </a>
              <a
                href="https://payhip.com/johnroddondoyano"
                target="_blank"
                rel="noopener noreferrer"
              >
                <span>MIDI/MusicXML Files</span>
              </a>
            </nav>
          </div>
          <p class="text-muted-foreground mt-24">
            Â© {new Date().getFullYear()} John Rod Dondoyano. All rights reserved.
          </p>
        </div>
      </footer>
    </main>
    <Toaster client:load richColors={true} />
  </body>
</html>
